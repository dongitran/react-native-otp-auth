import * as util from 'twilio/lib/jwt/taskrouter/util';
import * as FaxResponse from 'twilio/lib/twiml/FaxResponse';
import * as MessagingResponse from 'twilio/lib/twiml/MessagingResponse';
import * as VoiceResponse from 'twilio/lib/twiml/VoiceResponse';
import * as webhookTools from 'twilio/lib/webhooks/webhooks';

import TwilioClient = require('twilio/lib/rest/Twilio');
import AccessToken = require('twilio/lib/jwt/AccessToken');
import ClientCapability = require('twilio/lib/jwt/ClientCapability');
import TaskRouterCapability = require('twilio/lib/jwt/taskrouter/TaskRouterCapability');
import RequestClient = require('twilio/lib/base/RequestClient');

interface TwimlConstructor<T> {
  new (): T;
}

declare function twilio(
  accountSid?: string,
  authToken?: string,
  opts?: TwilioClient.TwilioClientOptions
): TwilioClient;

declare namespace twilio {
  export import Twilio = TwilioClient;
  export interface TwimlInterface {
    VoiceResponse: TwimlConstructor<VoiceResponse>;
    FaxResponse: TwimlConstructor<FaxResponse>;
    MessagingResponse: TwimlConstructor<MessagingResponse>;
  }
  export interface JwtInterface {
    AccessToken: typeof AccessToken;
    ClientCapability: typeof ClientCapability;
    taskrouter: {
      TaskRouterCapability: typeof TaskRouterCapability;
      util: typeof util;
    };
  }
  export const jwt: JwtInterface;
  export const twiml: TwimlInterface;
  export const RequestClient: RequestClient;
  export const validateRequest: typeof webhookTools.validateRequest;
  export const validateRequestWithBody: typeof webhookTools.validateRequestWithBody;
  export const validateExpressRequest: typeof webhookTools.validateExpressRequest;
  export const webhook: typeof webhookTools.webhook;
}

export = twilio;
